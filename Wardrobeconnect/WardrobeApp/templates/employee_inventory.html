{% extends 'base.html' %}
{% block content %}

<div class="container mt-4">
    <h2>Employee Inventory</h2>

    <!-- Success/Error Messages -->
    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">{{ message }}</div>
        {% endfor %}
    {% endif %}

    <!-- Add Product Form -->
    <a href="{% url 'employee_add_product' %}" class="btn btn-primary">Add New Product</a>

    <hr>
    <h3>Product List</h3>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Name</th>
                <th>Category</th>
                <th>Price ($)</th>
                <th>Stock</th>
                <th>Availability</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for product in products %}
            <tr>
                <td>{{ product.name }}</td>
                <td>{{ product.get_category_display }}</td>
                <td>{{ product.price }}</td>
                <td>{{ product.stock }}</td>
                <td>
                    <form method="POST" action="{% url 'update_availability' product.id %}">
                        {% csrf_token %}
                        <select name="availability" onchange="this.form.submit()">
                            {% for choice_key, choice_value in product.AVAILABILITY_CHOICES %}
                                <option value="{{ choice_key }}" {% if product.availability == choice_key %}selected{% endif %}>
                                    {{ choice_value }}
                                </option>
                            {% endfor %}
                        </select>
                    </form>
                </td>
                <td>
                    <form method="POST" action="{% url 'delete_product' product.id %}" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger btn-sm">Delete</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}
